<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>rxjs, redux-observable 入门 | Bougie&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="//zz.bdstatic.com/linksubmit/push.js" async="true"></script>
    <script>var _hmt = _hmt || [];_hmt.push(['_requirePlugin', 'UrlChangeTracker', {shouldTrackUrlChange: function (newPath, oldPath) {return newPath && oldPath;}}]);(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?16376e5ef47c0109a3fc57ac6fdf90ab";hm.async = true;document.body.appendChild(hm);})();</script>
    <meta name="description" content="RxJS 是微软公司推出的响应式编程的 JavaScript 库。官方文档称是能优雅地解决异步问题的 lodash">
    <meta name="google-site-verification" content="StUVyObxxRBratBwJpwLzrS9zUvlJLaL7Edy8WHYie4">
    
    <link rel="preload" href="/assets/css/0.styles.de3d0ff5.css" as="style"><link rel="preload" href="/assets/js/app.23ee6a8a.js" as="script"><link rel="preload" href="/assets/js/55.6965e980.js" as="script"><link rel="prefetch" href="/assets/js/10.121fd11d.js"><link rel="prefetch" href="/assets/js/11.18b69c9c.js"><link rel="prefetch" href="/assets/js/12.37f4e116.js"><link rel="prefetch" href="/assets/js/13.c4f5d85d.js"><link rel="prefetch" href="/assets/js/14.9a83fbba.js"><link rel="prefetch" href="/assets/js/15.2dd93dc2.js"><link rel="prefetch" href="/assets/js/16.e64baec6.js"><link rel="prefetch" href="/assets/js/17.0bdb62ae.js"><link rel="prefetch" href="/assets/js/18.baa32214.js"><link rel="prefetch" href="/assets/js/19.7b94f7c7.js"><link rel="prefetch" href="/assets/js/2.69398bed.js"><link rel="prefetch" href="/assets/js/20.5efe616f.js"><link rel="prefetch" href="/assets/js/21.1971a392.js"><link rel="prefetch" href="/assets/js/22.e623ce8c.js"><link rel="prefetch" href="/assets/js/23.cb4bb539.js"><link rel="prefetch" href="/assets/js/24.1860bb79.js"><link rel="prefetch" href="/assets/js/25.57a9a9f9.js"><link rel="prefetch" href="/assets/js/26.e560119f.js"><link rel="prefetch" href="/assets/js/27.c233ddc7.js"><link rel="prefetch" href="/assets/js/28.ea89edd4.js"><link rel="prefetch" href="/assets/js/29.416dc008.js"><link rel="prefetch" href="/assets/js/3.363a8091.js"><link rel="prefetch" href="/assets/js/30.d285920d.js"><link rel="prefetch" href="/assets/js/31.9e12a878.js"><link rel="prefetch" href="/assets/js/32.eb43f769.js"><link rel="prefetch" href="/assets/js/33.b3017c47.js"><link rel="prefetch" href="/assets/js/34.f17d5d1b.js"><link rel="prefetch" href="/assets/js/35.b3014aed.js"><link rel="prefetch" href="/assets/js/36.361fd917.js"><link rel="prefetch" href="/assets/js/37.23980ad0.js"><link rel="prefetch" href="/assets/js/38.c4a6f9fd.js"><link rel="prefetch" href="/assets/js/39.b1b74a44.js"><link rel="prefetch" href="/assets/js/4.d4e315a7.js"><link rel="prefetch" href="/assets/js/40.4f37870e.js"><link rel="prefetch" href="/assets/js/41.2592bb0b.js"><link rel="prefetch" href="/assets/js/42.a57d6d89.js"><link rel="prefetch" href="/assets/js/43.127eea70.js"><link rel="prefetch" href="/assets/js/44.405a7a24.js"><link rel="prefetch" href="/assets/js/45.f93d7ee8.js"><link rel="prefetch" href="/assets/js/46.0a77d2f7.js"><link rel="prefetch" href="/assets/js/47.021c92ab.js"><link rel="prefetch" href="/assets/js/48.7b30221d.js"><link rel="prefetch" href="/assets/js/49.211fb312.js"><link rel="prefetch" href="/assets/js/5.c16e4f99.js"><link rel="prefetch" href="/assets/js/50.d83bd5ab.js"><link rel="prefetch" href="/assets/js/51.2ad2df92.js"><link rel="prefetch" href="/assets/js/52.74246fd4.js"><link rel="prefetch" href="/assets/js/53.23995b1a.js"><link rel="prefetch" href="/assets/js/54.75fdda24.js"><link rel="prefetch" href="/assets/js/56.e2b6c3d6.js"><link rel="prefetch" href="/assets/js/57.be75b589.js"><link rel="prefetch" href="/assets/js/58.50507e25.js"><link rel="prefetch" href="/assets/js/59.c6c15c1a.js"><link rel="prefetch" href="/assets/js/6.346750d7.js"><link rel="prefetch" href="/assets/js/60.ed175ba0.js"><link rel="prefetch" href="/assets/js/61.c833af25.js"><link rel="prefetch" href="/assets/js/62.7816b3bb.js"><link rel="prefetch" href="/assets/js/63.9c9b7745.js"><link rel="prefetch" href="/assets/js/64.8ef020e1.js"><link rel="prefetch" href="/assets/js/65.b5756776.js"><link rel="prefetch" href="/assets/js/66.4e375c5c.js"><link rel="prefetch" href="/assets/js/67.1ca9d234.js"><link rel="prefetch" href="/assets/js/68.c44470e1.js"><link rel="prefetch" href="/assets/js/69.3537d2ed.js"><link rel="prefetch" href="/assets/js/7.5edb2c2a.js"><link rel="prefetch" href="/assets/js/70.35ae0feb.js"><link rel="prefetch" href="/assets/js/71.7558c96d.js"><link rel="prefetch" href="/assets/js/72.6965aa63.js"><link rel="prefetch" href="/assets/js/73.97d4f80a.js"><link rel="prefetch" href="/assets/js/74.e99fd764.js"><link rel="prefetch" href="/assets/js/75.61ef53ce.js"><link rel="prefetch" href="/assets/js/76.f69fc7a0.js"><link rel="prefetch" href="/assets/js/77.b75fba22.js"><link rel="prefetch" href="/assets/js/78.e9cae7e0.js"><link rel="prefetch" href="/assets/js/79.a161590f.js"><link rel="prefetch" href="/assets/js/8.c4e48df2.js"><link rel="prefetch" href="/assets/js/80.0afc3073.js"><link rel="prefetch" href="/assets/js/81.44f27792.js"><link rel="prefetch" href="/assets/js/82.17d4f471.js"><link rel="prefetch" href="/assets/js/83.726a9101.js"><link rel="prefetch" href="/assets/js/84.a918f87a.js"><link rel="prefetch" href="/assets/js/85.b654098e.js"><link rel="prefetch" href="/assets/js/86.2cc73dbc.js"><link rel="prefetch" href="/assets/js/87.8ad9e9df.js"><link rel="prefetch" href="/assets/js/88.97ec9316.js"><link rel="prefetch" href="/assets/js/89.f72be2bc.js"><link rel="prefetch" href="/assets/js/9.23daae82.js"><link rel="prefetch" href="/assets/js/90.b7200141.js"><link rel="prefetch" href="/assets/js/91.c67d9181.js"><link rel="prefetch" href="/assets/js/92.66560dfc.js"><link rel="prefetch" href="/assets/js/93.44099ffc.js"><link rel="prefetch" href="/assets/js/94.c2a7abba.js"><link rel="prefetch" href="/assets/js/95.54e1ca0b.js"><link rel="prefetch" href="/assets/js/96.f04d7d07.js"><link rel="prefetch" href="/assets/js/97.aa615c60.js"><link rel="prefetch" href="/assets/js/98.3399a774.js"><link rel="prefetch" href="/assets/js/99.de1900fd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.de3d0ff5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div><nav class="navbar"><div class="left"><svg viewBox="0 0 1024 1024" width="200" height="200" class="icon-menu"><path d="M128 256h768v85.333333H128z m0 213.333333h768v85.333334H128z m0 213.333334h768v85.333333H128z" fill p-id="1239"></path></svg> <span class="spacer"></span> <a href="/" class="router-link-active"><img src="/logo.png" alt="" class="logo"> <div class="title">Bougie's Blog</div></a> <span class="theme-mobile"><span class="spacer"></span> <select class="theme-selector"><option value="">🌓</option> <option value="light">🌞</option> <option value="dark">🌛</option></select></span></div> <div class="right"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <ul class="links"><li><a href="https://github.com/bougieL" target="_blank" rel="nofollow me noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon-outlink"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://juejin.im/user/5afce30551882542672641e4" target="_blank" rel="nofollow me noopener noreferrer">掘金<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon-outlink"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://bougieL.github.io/rss.xml" target="_blank" rel="nofollow me noopener noreferrer">RSS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon-outlink"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li class="theme"><select class="theme-selector"><option value="">🌓</option> <option value="light">🌞</option> <option value="dark">🌛</option></select></li></ul></div></nav> <div class="navbar placeholder"></div></div> <div class="sidebar-mask"><div class="sidebar"><ul class="nav"><li><a href="https://github.com/bougieL" target="_blank" rel="nofollow me noopener noreferrer">GitHub <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon-outlink"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://juejin.im/user/5afce30551882542672641e4" target="_blank" rel="nofollow me noopener noreferrer">掘金 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon-outlink"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://bougieL.github.io/rss.xml" target="_blank" rel="nofollow me noopener noreferrer">RSS <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon-outlink"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <ul class="side"><li><a href="/" class="router-link-active">博客</a></li><li><a href="/tag/">标签</a></li><li><a href="/labs/">实验室</a></li><li><a href="/collection/">收藏</a></li><li><a href="/daily/">日常</a></li><li><a href="/say/">说说</a></li><li><a href="/message/">留言板</a></li><li><a href="/friends/">友情链接</a></li><li><a href="/about/">关于</a></li></ul></div></div> <main class="page"><div class="content__default"><h1 class="content__title">rxjs, redux-observable 入门</h1> <ul class="article-info"><li>作者：Bougie</li> <li>创建于：2019-07-20</li> <li>更新于：2023-03-09</li></ul> <ul class="article-info tags"><li><a href="/tag/FrontEnd" style="background:#2B2F3B;">
        前端
      </a></li><li><a href="/tag/Flux" style="background:#333333;">
        Flux
      </a></li><li><a href="/tag/Reactive" style="background:#da6d32;">
        Reactive
      </a></li></ul> <div class="content__post content__default"><p><img src="/images/2019/07/21/ep5OIJ.png" alt="ep5OIJ.png" width="1200" height="415" loading="lazy"></p> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <blockquote><p>RxJS 是使用 Observables 的响应式编程的库，它使编写异步或基于回调的代码更容易。这个项目是 Reactive-Extensions/RxJS(RxJS 4) 的重写，具有更好的性能、更好的模块性、更好的可调试调用堆栈，同时保持大部分向后兼容，只有一些破坏性的变更(breaking changes)是为了减少外层的 API，官方文档称是能优雅地解决异步问题的 lodash。</p></blockquote> <p>粗略了解了一下感觉说 rxjs 是解决异步问题的 loadash 不太准确，因为 async.js 才是解决异步问题的 lodash。rxjs 更像一种状态管理库。不过并没有热门的 rxjs-react 之类的库实现对 React 组件的状态注入。倒是 redux 的中间件 - redux-observable 跟 rxjs 联系较紧密。</p> <h2 id="observable-创建可观察对象"><a href="#observable-创建可观察对象" class="header-anchor">#</a> Observable - 创建可观察对象</h2> <p><strong>create</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'rxjs'</span>
<span class="token keyword">const</span> hello <span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  observer<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span>
  observer<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'World'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 输出: 'Hello'...'World'</span>
<span class="token keyword">const</span> subscribe <span class="token operator">=</span> hello<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>这个 create 是比较难理解的一点。因为通常的数据观察库像 redux, mobx, dobjs, 还有 vue 里面的双向绑定创建的往往是一个可观察对象。</p> <p>以 mobx 为例：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> observable<span class="token punctuation">,</span> computed<span class="token punctuation">,</span> action<span class="token punctuation">,</span> reaction <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'mobx'</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token keyword">class</span> <span class="token punctuation">{</span>
  @observable store <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
  @computed <span class="token keyword">get</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span>count
  <span class="token punctuation">}</span>
  @action <span class="token function-variable function">addcount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span>count<span class="token operator">++</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">reaction</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> store<span class="token punctuation">.</span>count<span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">count<span class="token punctuation">,</span> reaction</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ref<span class="token punctuation">.</span>current <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ref<span class="token punctuation">.</span>current<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> count<span class="token punctuation">)</span>
    <span class="token comment">// reaction.dispose() // 只响应一次</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">addcount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  store<span class="token punctuation">.</span><span class="token function">addcount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>
</code></pre></div><p>然而 RxJS 主张流式数据和链式操作，因此和常规方法不太相同。上述 create 的写法类似迭代器一样，那么它的可观察性体现在哪里呢？常规的观察者模式实现方法有 <code>Object.defineProperty</code> 和 <code>Proxy</code>，显然 RxJS 两者都不是。</p> <p>官方的解释是 RxJS 实现了一种数据推送机制。<strong>什么是推送？</strong> - 在推送体系中，由生产者来决定何时把数据发送给消费者。消费者本身不知道何时会接收到数据。</p> <p>RxJS 引入了 Observables，一个新的 JavaScript 推送体系。Observable 是多个值的生产者，并将值“推送”给观察者(消费者)。</p> <p><strong>subscribe</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>observable<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  observable<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>
<span class="token comment">// 输出 hello world</span>
<span class="token comment">// 3s 后输出 hellow world</span>
</code></pre></div><p><strong>unsubscribe</strong></p> <p>subscribe 方法返回一个 subscription，subscription 上面有个 unsubscribe 方法，用于取消订阅</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> observable <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> subscription <span class="token operator">=</span> observable<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 稍后：</span>
subscription<span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Observable 是惰性运算，只有在每个观察者订阅后才会执行</p> <p><strong>Observer</strong></p> <p>RxJS 里面观察者即消费者</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Observer got a next value: '</span> <span class="token operator">+</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">error</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Observer got an error: '</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Observer got a complete notification'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
observable<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span>
</code></pre></div><p><strong>subject</strong></p> <p>Subject 像是 Observable，但是可以多播给多个观察者。Subject 还像是 EventEmitters，维护着多个监听器的注册表。</p> <p>Subject 是 Observer，它可以被 Subscribe。</p> <p>Subject 可能是 RxJS 中最难理解的概念了，因为 Subject 既可以作为一个可观察对象（Observable）去订阅其它 Observer，也可以作为一个 Observer 被 Subscribe。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> subject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rx<span class="token punctuation">.</span>Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

subject<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'observerA: '</span> <span class="token operator">+</span> v<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'observerB: '</span> <span class="token operator">+</span> v<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

subject<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
subject<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>BehaviorSubject</strong></p> <p>有初始值的 Subject，官方解释是：</p> <blockquote><p>BehaviorSubjects 适合用来表示“随时间推移的值”。举例来说，生日的流是一个 Subject，但年龄的流应该是一个 BehaviorSubject 。</p></blockquote> <p>简直了，就不能给 Subject 加个初始值么 🤦‍，非要强加一个概念。</p> <h2 id="operators-操作符"><a href="#operators-操作符" class="header-anchor">#</a> Operators - 操作符</h2> <blockquote><p>操作符是函数，它基于当前的 Observable 创建一个新的 Observable。这是一个无副作用的操作：前面的 Observable 保持不变。</p></blockquote> <h2 id="关于流"><a href="#关于流" class="header-anchor">#</a> 关于流</h2> <p><strong>计算机中的流分为二进制流和文本流</strong></p> <ul><li>文本流是解释性的，最长可达 255 个字符，其中回车/换行将被转换为换行符“\n”，（如果以&quot;文本&quot;方式打开一个文件，那么在读字符的时候，系统会把所有的&quot;\r\n&quot;序列转成&quot;\n&quot;，在写入时把&quot;\n&quot;转成&quot;\r\n&quot;）。注： \n 一般会操作系统被翻译成&quot;行的结束&quot;，即 LF(Line-Feed)； \r 会被翻译成&quot;回车&quot;，即 CR(Cariage-Return)</li> <li>而二进制流是非解释性的，一次处理一个字符，并且不转换字符。</li></ul> <p><strong>流的特性</strong></p> <ul><li>多个流可合并成一个流</li> <li>一个流可拆分成多个流</li> <li>可在管道中处理</li></ul> <p><strong>RxJS 中的流</strong></p> <ul><li>只是引用了流的概念，并非二进制流和文本流</li></ul></div> <div class="page-jump"><a href="/2019/07/01/vue-3-0-%E6%96%B0%E7%89%B9%E6%80%A7%E6%80%BB%E7%BB%93/">&lt; Vue 3.0 新特性总结</a> <span></span> <a href="/2019/07/27/%E8%B7%AF%E5%9C%A8%E4%BD%95%E6%96%B9/">路在何方 &gt;</a></div> <div id="comment"></div></div> <ul class="footer-wrapper content__default"><li><div class="title">关于本站</div> <div class="text"><span>Bougie © 2017-2023</span></div> <div class="text"><a href="https://beian.miit.gov.cn/" rel="noopener noreferrer" target="_blank">鄂ICP备17030443号-1</a></div></li> <li><div class="title">小伙伴们</div> <div title="" class="text"><a href="https://www.chegi.fun/" target="_blank">Chegi's Space</a></div><div title="欢迎来访！" class="text"><a href="http://www.zhangningle.top" target="_blank">张宁乐</a></div></li> <li><div class="title">联系方式</div> <div class="text"><a href="mailto:bougie.liu@qq.com">邮箱：bougie.liu@qq.com</a></div> <div class="text"><a href="/message/">留言：点击留言</a></div></li></ul></main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.23ee6a8a.js" defer></script><script src="/assets/js/55.6965e980.js" defer></script>
  </body>
</html>
