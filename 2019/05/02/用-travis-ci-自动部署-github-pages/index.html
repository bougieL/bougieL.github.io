<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>用 Travis CI 自动部署 Github Pages | Bougie&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="//zz.bdstatic.com/linksubmit/push.js" async="true"></script>
    <script>var _hmt = _hmt || [];_hmt.push(['_requirePlugin', 'UrlChangeTracker', {shouldTrackUrlChange: function (newPath, oldPath) {return newPath && oldPath;}}]);(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?16376e5ef47c0109a3fc57ac6fdf90ab";hm.async = true;document.body.appendChild(hm);})();</script>
    <meta name="description" content="Github Pages 不能运行动态程序，只能输出一些静态内容。因此 Github Pages 非常适合用于前端项目的展示。可用于存放项目介绍、项目文档或者个人博客。本文介绍了怎么用 Travis CI 自动化部署 Github Pages。">
    <meta name="viewport" content="user-scalable=no, initial-scale=1,maximum-scale=1, width=device-width">
    
    <link rel="preload" href="/assets/css/0.styles.65cb42a7.css" as="style"><link rel="preload" href="/assets/js/app.49e42e06.js" as="script"><link rel="preload" href="/assets/js/46.b95aad07.js" as="script"><link rel="prefetch" href="/assets/js/10.bdca252b.js"><link rel="prefetch" href="/assets/js/100.b4bde06f.js"><link rel="prefetch" href="/assets/js/101.f052c46c.js"><link rel="prefetch" href="/assets/js/11.f9f87556.js"><link rel="prefetch" href="/assets/js/12.2c54d9b2.js"><link rel="prefetch" href="/assets/js/13.2eade34c.js"><link rel="prefetch" href="/assets/js/14.5ce597ea.js"><link rel="prefetch" href="/assets/js/15.d403ccfe.js"><link rel="prefetch" href="/assets/js/16.5aec1919.js"><link rel="prefetch" href="/assets/js/17.a923e771.js"><link rel="prefetch" href="/assets/js/18.5987c004.js"><link rel="prefetch" href="/assets/js/19.e0864ca9.js"><link rel="prefetch" href="/assets/js/2.b70f3271.js"><link rel="prefetch" href="/assets/js/20.fe458423.js"><link rel="prefetch" href="/assets/js/21.ea761caf.js"><link rel="prefetch" href="/assets/js/22.17de7daa.js"><link rel="prefetch" href="/assets/js/23.232ef2e9.js"><link rel="prefetch" href="/assets/js/24.f1591df6.js"><link rel="prefetch" href="/assets/js/25.1d345f13.js"><link rel="prefetch" href="/assets/js/26.89de8c96.js"><link rel="prefetch" href="/assets/js/27.ea896af9.js"><link rel="prefetch" href="/assets/js/28.7821cc12.js"><link rel="prefetch" href="/assets/js/29.af2c49d2.js"><link rel="prefetch" href="/assets/js/3.214a5109.js"><link rel="prefetch" href="/assets/js/30.89aa4864.js"><link rel="prefetch" href="/assets/js/31.11330365.js"><link rel="prefetch" href="/assets/js/32.23d3a0fb.js"><link rel="prefetch" href="/assets/js/33.46851dc7.js"><link rel="prefetch" href="/assets/js/34.62e9ed21.js"><link rel="prefetch" href="/assets/js/35.2540b7e6.js"><link rel="prefetch" href="/assets/js/36.286ca8a1.js"><link rel="prefetch" href="/assets/js/37.04955a64.js"><link rel="prefetch" href="/assets/js/38.6df7dc70.js"><link rel="prefetch" href="/assets/js/39.39060479.js"><link rel="prefetch" href="/assets/js/4.dd206415.js"><link rel="prefetch" href="/assets/js/40.8075ca49.js"><link rel="prefetch" href="/assets/js/41.09665a7b.js"><link rel="prefetch" href="/assets/js/42.7e79db27.js"><link rel="prefetch" href="/assets/js/43.6224918a.js"><link rel="prefetch" href="/assets/js/44.d480e632.js"><link rel="prefetch" href="/assets/js/45.22cfbe2c.js"><link rel="prefetch" href="/assets/js/47.92858d0c.js"><link rel="prefetch" href="/assets/js/48.21d54e95.js"><link rel="prefetch" href="/assets/js/49.00ff5ec0.js"><link rel="prefetch" href="/assets/js/5.d024e667.js"><link rel="prefetch" href="/assets/js/50.9acacbee.js"><link rel="prefetch" href="/assets/js/51.eccc8a51.js"><link rel="prefetch" href="/assets/js/52.70bd8050.js"><link rel="prefetch" href="/assets/js/53.d97e52b2.js"><link rel="prefetch" href="/assets/js/54.646ee100.js"><link rel="prefetch" href="/assets/js/55.05549442.js"><link rel="prefetch" href="/assets/js/56.195ea0de.js"><link rel="prefetch" href="/assets/js/57.e96e8580.js"><link rel="prefetch" href="/assets/js/58.2fef3887.js"><link rel="prefetch" href="/assets/js/59.b2f3cf48.js"><link rel="prefetch" href="/assets/js/6.37ac22fc.js"><link rel="prefetch" href="/assets/js/60.78a3ac11.js"><link rel="prefetch" href="/assets/js/61.1aa6762b.js"><link rel="prefetch" href="/assets/js/62.ec3beac3.js"><link rel="prefetch" href="/assets/js/63.078c313a.js"><link rel="prefetch" href="/assets/js/64.eea8ee19.js"><link rel="prefetch" href="/assets/js/65.fcb1b5bc.js"><link rel="prefetch" href="/assets/js/66.9266443c.js"><link rel="prefetch" href="/assets/js/67.9119b628.js"><link rel="prefetch" href="/assets/js/68.e0a7e3a1.js"><link rel="prefetch" href="/assets/js/69.a0be4b33.js"><link rel="prefetch" href="/assets/js/7.04fab2c2.js"><link rel="prefetch" href="/assets/js/70.08060d77.js"><link rel="prefetch" href="/assets/js/71.d6064f5f.js"><link rel="prefetch" href="/assets/js/72.ebac6460.js"><link rel="prefetch" href="/assets/js/73.0b55d35a.js"><link rel="prefetch" href="/assets/js/74.134c3c11.js"><link rel="prefetch" href="/assets/js/75.a9502c25.js"><link rel="prefetch" href="/assets/js/76.48658994.js"><link rel="prefetch" href="/assets/js/77.d6a36797.js"><link rel="prefetch" href="/assets/js/78.04e57607.js"><link rel="prefetch" href="/assets/js/79.30b5dd6a.js"><link rel="prefetch" href="/assets/js/8.fc8bcea5.js"><link rel="prefetch" href="/assets/js/80.630c69bb.js"><link rel="prefetch" href="/assets/js/81.770d22a1.js"><link rel="prefetch" href="/assets/js/82.2e4c9fe5.js"><link rel="prefetch" href="/assets/js/83.93fd5b6e.js"><link rel="prefetch" href="/assets/js/84.f39026c2.js"><link rel="prefetch" href="/assets/js/85.939d134b.js"><link rel="prefetch" href="/assets/js/86.6e157988.js"><link rel="prefetch" href="/assets/js/87.1c824200.js"><link rel="prefetch" href="/assets/js/88.26b9c47b.js"><link rel="prefetch" href="/assets/js/89.3d93adec.js"><link rel="prefetch" href="/assets/js/9.c6e7e1e0.js"><link rel="prefetch" href="/assets/js/90.1cca704c.js"><link rel="prefetch" href="/assets/js/91.4c02f525.js"><link rel="prefetch" href="/assets/js/92.6634b27e.js"><link rel="prefetch" href="/assets/js/93.b688394d.js"><link rel="prefetch" href="/assets/js/94.99f8e713.js"><link rel="prefetch" href="/assets/js/95.9a61d4fb.js"><link rel="prefetch" href="/assets/js/96.16dd7fe7.js"><link rel="prefetch" href="/assets/js/97.122936df.js"><link rel="prefetch" href="/assets/js/98.af3004fc.js"><link rel="prefetch" href="/assets/js/99.26ba8bb3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.65cb42a7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div><nav class="navbar"><div class="left"><svg viewBox="0 0 1024 1024" width="200" height="200" class="icon-menu"><path d="M128 256h768v85.333333H128z m0 213.333333h768v85.333334H128z m0 213.333334h768v85.333333H128z" fill p-id="1239"></path></svg> <span class="spacer"></span> <a href="/" class="router-link-active"><img src="/logo.png" alt="" class="logo"> <div class="title">Bougie's Blog</div></a> <span class="theme-mobile"><span class="spacer"></span> <select class="theme-selector"><option value="">🌓</option> <option value="light">🌞</option> <option value="dark">🌛</option></select></span></div> <div class="right"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <ul class="links"><li><a href="https://github.com/bougieL" target="_blank" rel="nofollow me noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon-outlink"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://juejin.im/user/5afce30551882542672641e4" target="_blank" rel="nofollow me noopener noreferrer">掘金<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon-outlink"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://bougieL.github.io/rss.xml" target="_blank" rel="nofollow me noopener noreferrer">RSS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon-outlink"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li class="theme"><select class="theme-selector"><option value="">🌓</option> <option value="light">🌞</option> <option value="dark">🌛</option></select></li></ul></div></nav> <div class="navbar placeholder"></div></div> <div class="sidebar-mask"><div class="sidebar"><ul class="nav"><li><a href="https://github.com/bougieL" target="_blank" rel="nofollow me noopener noreferrer">GitHub <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon-outlink"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://juejin.im/user/5afce30551882542672641e4" target="_blank" rel="nofollow me noopener noreferrer">掘金 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon-outlink"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://bougieL.github.io/rss.xml" target="_blank" rel="nofollow me noopener noreferrer">RSS <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon-outlink"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <ul class="side"><li><a href="/" class="router-link-active">博客</a></li><li><a href="/tag/">标签</a></li><li><a href="/labs/">实验室</a></li><li><a href="/collection/">收藏</a></li><li><a href="/daily/">日常</a></li><li><a href="/say/">说说</a></li><li><a href="/message/">留言板</a></li><li><a href="/friends/">友情链接</a></li><li><a href="/about/">关于</a></li></ul></div></div> <main class="page"><div class="content__default"><h1 class="content__title">用 Travis CI 自动部署 Github Pages</h1> <ul class="article-info"><li>作者：Bougie</li> <li>创建于：2019-05-02</li> <li>更新于：2023-03-09</li></ul> <ul class="article-info tags"><li><a href="/tag/Git" style="background:#333333;">
        Git/GitHub
      </a></li><li><a href="/tag/Linux" style="background:#2D8CF0;">
        Linux
      </a></li></ul> <div class="content__post content__default"><p><img src="/images/2019/05/02/EtjGbq.png" alt="EtjGbq.png" width="1108" height="512" loading="lazy"></p> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>Github Pages 不能运行动态程序，只能输出一些静态内容。因此 Github Pages 非常适合用于前端项目的展示。可用于存放项目介绍、项目文档或者个人博客。本文介绍了怎么用 Travis CI 自动化部署 Github Pages。</p> <h2 id="关于-ci"><a href="#关于-ci" class="header-anchor">#</a> 关于 CI</h2> <p>持续集成（Continuous integration）是一种软件开发实践，即团队开发成员经常集成他们的工作，通常每个成员每天至少集成一次，也就意味着每天可能会发生多次集成。每次集成都通过自动化的构建（包括编译，发布，自动化测试）来验证，从而尽早地发现集成错误。目前 github 开源项目用的较多的 CI 主要是 Circle CI 和 Travis CI，两者都是利用容器技术来适配不同项目环境。</p> <p><img src="https://marketplace-screenshots.githubusercontent.com/7/edd31f74-33e3-11e7-8899-c8ceb4d795d2" alt="Circle CI" loading="lazy"></p> <p><img src="https://marketplace-screenshots.githubusercontent.com/4/39671580-33e9-11e7-8b05-45f514dad0b8" alt="Travis CI" loading="lazy"></p> <p>(图一 CIrcle CI，图二 Travis CI)</p> <h2 id="步骤"><a href="#步骤" class="header-anchor">#</a> 步骤</h2> <h3 id="_1-安装-github-app"><a href="#_1-安装-github-app" class="header-anchor">#</a> 1. 安装 Github App</h3> <p>在 <a href="https://github.com/marketplace" target="_blank" rel="noopener noreferrer">Github Market Place<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 安装 Travis CI。安装时选择你想要的项目权限。
<img src="/images/2019/05/02/ENCylT.png" width="50%" alt="ENCylT.png" title="ENCylT.png"></p> <h3 id="_2-配置-github-token"><a href="#_2-配置-github-token" class="header-anchor">#</a> 2. 配置 Github Token</h3> <p>配置 Github Token 用于 Travis CI 对你项目的访问权限，配置完了之后 <strong>不要刷新页面，先点一下 Token 后面的复制按钮</strong>，因为你只能看见这个 Token 一次，刷新了它就没了 😂 不得不赞一下 Github 的安全性 👍
<img src="/images/2019/05/03/ENjIns.png" alt="ENjIns.png" width="1200" height="254" loading="lazy"></p> <h3 id="_3-加密-github-token"><a href="#_3-加密-github-token" class="header-anchor">#</a> 3. 加密 Github Token</h3> <p>以下是 Travis CI 官方文档的 Github Pages 配置示例：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">deploy</span><span class="token punctuation">:</span>
  <span class="token key atrule">provider</span><span class="token punctuation">:</span> pages
  <span class="token key atrule">skip_cleanup</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">github_token</span><span class="token punctuation">:</span> $GITHUB_TOKEN <span class="token comment"># Set in the settings page of your repository, as a secure variable</span>
  <span class="token key atrule">keep_history</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">on</span><span class="token punctuation">:</span>
    <span class="token key atrule">branch</span><span class="token punctuation">:</span> master
</code></pre></div><p><code>$GITHUB_TOKEN</code> 是加密后的环境变量。如果不加密直接提交明文到一个 Repo 的话，github 会直接删除掉这个 token，简直太安全了 😂 加密步骤为</p> <div class="language-bash extra-class"><pre class="language-bash"><code>gem <span class="token function">install</span> travis      <span class="token comment"># Travis CI 官方 cli 工具</span>
travis login <span class="token parameter variable">--pro</span>      <span class="token comment"># 登录 Travis CI ，账号密码为你 Github 的账号密码</span>
travis encrypt <span class="token string">'GITHUB_TOKEN=&lt;YOUR_GITHUB_TOKEN&gt;'</span> <span class="token parameter variable">--add</span>     <span class="token comment"># 加密 github token 并自动添加至配置文件</span>
</code></pre></div><h3 id="_4-配置-travis-yml"><a href="#_4-配置-travis-yml" class="header-anchor">#</a> 4. 配置 <code>.travis.yml</code></h3> <p>完整的 <code>.travis.yml</code> 配置示例，需要将前面加密的 github token 解密，当然只有 Travis CI 知道解密后的结果是啥 👊</p> <p>地址：<a href="https://github.com/bougieL/bougie-design/blob/master/.travis.yml" target="_blank" rel="noopener noreferrer">Bougie Design Travis CI config<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">language</span><span class="token punctuation">:</span> node_js
<span class="token key atrule">node_js</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">'10'</span>
<span class="token key atrule">before_install</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> composer config <span class="token punctuation">-</span><span class="token punctuation">-</span>global github<span class="token punctuation">-</span>oauth.github.com &quot;$GITHUB_TOKEN&quot;
<span class="token key atrule">install</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> yarn
<span class="token key atrule">test</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">script</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> yarn docs<span class="token punctuation">:</span>build
  <span class="token punctuation">-</span> cp <span class="token punctuation">-</span>r ./.docz/dist/* .
<span class="token key atrule">deploy</span><span class="token punctuation">:</span>
  <span class="token key atrule">provider</span><span class="token punctuation">:</span> pages
  <span class="token key atrule">skip_cleanup</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">github_token</span><span class="token punctuation">:</span> $GITHUB_TOKEN
  <span class="token key atrule">keep_history</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">on</span><span class="token punctuation">:</span>
    <span class="token key atrule">branch</span><span class="token punctuation">:</span> master
<span class="token key atrule">env</span><span class="token punctuation">:</span>
  <span class="token key atrule">global</span><span class="token punctuation">:</span>
    <span class="token key atrule">secure</span><span class="token punctuation">:</span> TTQLIDz0jL4FRFrpq6DDocxLiELUSpJsj9phdmjW9Eg9kna73KjPF2XmZaWFvkObZU3og/7Thr/iwsXQqfdq8gHShhLkHZAZqgvWqbjMIQABYIFqqqUE9grrPdrLXWVAidh+nET+pjes8VX92NBz6HA+i/15+PugVwYhC85AGyNN2JRL7nxCwh2ECiKATRiX+cLmVqFwTGpzqHovAiBFnap17whWa4C4uVEzdBwjQAZKw+IFxiiJIA7hkFTTThS11uCx//Dr7/A1X7c6ZLao/qiwvW8fNAbhV5ZA6dx4a0vtLwj6lprjcwWuGQX/vutKHnpdNpxeIDhmLNspN1U7YxjgUZJXgFjpE6tw1I8N6nSRpzhPUlrXPkKUAdN9x2jN20NSUeFDSl0FhazPwhGWzlSQb0gNyH1U04wvw3QB2VP/3UvTiyCZjum6prTpuXy/D262smG97o0/0XlNySX6MC+OLQNDIVgzO4YO2IHVB8lW6CBSMeTlcE8a4yvHwmGQpLKnX6tY06/n8lvjgZgPKZaRZL6aVrBE+/104Gt/aBFpraZZpiXJjXjdm4TO3N+u8gT8+gkDJ0BvzrX7Kf/W/WouecziCJgzYCB7y8eqec4kmZKRs2O6zyKJ0SbPrW54UuCmjFzTLEmdRCXRLIbEQsWvS5x+FKKwGNGRcrgPjxY=
</code></pre></div><h3 id="_5-触发-ci"><a href="#_5-触发-ci" class="header-anchor">#</a> 5. 触发 CI</h3> <p>一般默认是 git push 时触发，也可以修改成 tag 时触发，push 后可以到 travis-ci.com 查看 CI 日志。如果出现下图所示日志，则表明部署 Github Pages 成功了
<img src="/images/2019/05/03/ENzmkt.png" width="50%" alt="ENzmkt.png" title="ENzmkt.png"></p> <h3 id="_6-查看-github-pages"><a href="#_6-查看-github-pages" class="header-anchor">#</a> 6. 查看 Github Pages</h3> <p>Travis CI 会自动创建一个叫 gh-pages 的分支，如图所示：
<img src="/images/2019/05/03/ENz8mj.png" width="50%" alt="ENz8mj.png" title="ENz8mj.png"></p> <p>到项目设置中设置 Github Pages 分支为 gh-pages：
<img src="/images/2019/05/03/EUSNbd.png" alt="EUSNbd.png" width="1200" height="485" loading="lazy"></p> <p>访问 <code>https://your-github-id.github.io/repo-name/</code> 即可访问 Github Pages 了。需要注意的是 Github Pages 的 root path 不是 <code>/</code>，而是 <code>/repo-name/</code>，因此在打包时记得把基础路由设置成 <code>/repo-name/</code>，否则会出现资源路径错误的情况。</p> <h2 id="_2019-06-23-更新"><a href="#_2019-06-23-更新" class="header-anchor">#</a> 2019-06-23 更新</h2> <p>换了一个 Repo ，继续用原来的 <code>GitHub Token</code> 不知道怎么就行不通了。</p> <p>错误截图：
<img src="/images/2019/06/23/ZicXHf.png" alt="ZicXHf.png" width="1086" height="124" loading="lazy"></p> <p>对比正确截图为：
<img src="/images/2019/06/23/Zig5q0.png" alt="Zig5q0.png" width="1022" height="202" loading="lazy"></p> <p>看错误应该是 Token 认证出了问题。难道是一个 <code>Token</code> 只能给一个仓库使用？抑或是一个 <code>Token</code> 只能给一台机器使用？网上找了半天也没找到结果。<code>CI</code> 还是适合用于软件自动化测试、<code>tag</code> 发版，用于部署 <code>GitHub Pages</code> 似乎有点小题大做了，最终决定改用 <code>Netlify</code> 无脑部署了。<code>Netlify</code> 具有配置重定向的功能，因此可以防止 <code>SPA</code> 网站刷新 404。</p> <p>配置方法为，在站点根目录创建 <code>_redirects</code> 文件：</p> <div class="language- extra-class"><pre class="language-text"><code>/*      /index.html       200
</code></pre></div><p>最后的 200 状态码必须要写，不写的话会默认状态码为 302 ，页面地址会变为 <code>/index.html</code>。</p> <h2 id="附-阮老师对几个-持续-概念的解释"><a href="#附-阮老师对几个-持续-概念的解释" class="header-anchor">#</a> 附：阮老师对几个“持续“概念的解释</h2> <h3 id="一、概念"><a href="#一、概念" class="header-anchor">#</a> 一、概念</h3> <p><strong>持续集成（Continuous integration）指的是，频繁地（一天多次）将代码集成到主干。</strong></p> <p>它的好处主要有两个。</p> <blockquote><p><strong>（1）快速发现错误。</strong> 每完成一点更新，就集成到主干，可以快速发现错误，定位错误也比较容易。</p> <p><strong>（2）防止分支大幅偏离主干。</strong> 如果不是经常集成，主干又在不断更新，会导致以后集成的难度变大，甚至难以集成。</p></blockquote> <p><strong>持续集成的目的，就是让产品可以快速迭代，同时还能保持高质量。</strong> 它的核心措施是，代码集成到主干之前，必须通过自动化测试。只要有一个测试用例失败，就不能集成。</p> <p>Martin Fowler 说过，&quot;持续集成并不能消除 Bug，而是让它们非常容易发现和改正。&quot;</p> <p>与持续集成相关的，还有两个概念，分别是持续交付和持续部署。</p> <h3 id="二、持续交付"><a href="#二、持续交付" class="header-anchor">#</a> 二、持续交付</h3> <p><strong>持续交付（Continuous delivery）指的是，频繁地将软件的新版本，交付给质量团队或者用户，以供评审。</strong> 如果评审通过，代码就进入生产阶段。</p> <p>持续交付可以看作持续集成的下一步。它强调的是，不管怎么更新，软件是随时随地可以交付的。</p> <h3 id="三、持续部署"><a href="#三、持续部署" class="header-anchor">#</a> 三、持续部署</h3> <p><strong>持续部署（continuous deployment）是持续交付的下一步，指的是代码通过评审以后，自动部署到生产环境。</strong></p> <p>持续部署的目标是，代码在任何时刻都是可部署的，可以进入生产阶段。</p> <p>持续部署的前提是能自动化完成测试、构建、部署等步骤。它与持续交付的区别，可以参考下图。</p> <p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015092302.jpg" alt="" loading="lazy"></p> <p>（<a href="http://blog.crisp.se/2013/02/05/yassalsundman/continuous-delivery-vs-continuous-deployment" target="_blank" rel="noopener noreferrer">图片来源<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</p> <h3 id="四、流程"><a href="#四、流程" class="header-anchor">#</a> 四、流程</h3> <p>根据持续集成的设计，代码从提交到生产，整个过程有以下几步。</p> <h4 id="_4-1-提交"><a href="#_4-1-提交" class="header-anchor">#</a> 4.1 提交</h4> <p>流程的第一步，是开发者向代码仓库提交代码。所有后面的步骤都始于本地代码的一次提交（commit）。</p> <h4 id="_4-2-测试-第一轮"><a href="#_4-2-测试-第一轮" class="header-anchor">#</a> 4.2 测试（第一轮）</h4> <p>代码仓库对 commit 操作配置了钩子（hook），只要提交代码或者合并进主干，就会跑自动化测试。</p> <p>测试有好几种。</p> <blockquote><ul><li>单元测试：针对函数或模块的测试</li> <li>集成测试：针对整体产品的某个功能的测试，又称功能测试</li> <li>端对端测试：从用户界面直达数据库的全链路测试</li></ul></blockquote> <p>第一轮至少要跑单元测试。</p> <h4 id="_4-3-构建"><a href="#_4-3-构建" class="header-anchor">#</a> 4.3 构建</h4> <p>通过第一轮测试，代码就可以合并进主干，就算可以交付了。</p> <p>交付后，就先进行构建（build），再进入第二轮测试。所谓构建，指的是将源码转换为可以运行的实际代码，比如安装依赖，配置各种资源（样式表、JS 脚本、图片）等等。</p> <p>常用的构建工具如下。</p> <blockquote><ul><li><a href="http://jenkins-ci.org/" target="_blank" rel="noopener noreferrer">Jenkins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://Travis-ci.com/" target="_blank" rel="noopener noreferrer">Travis<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.codeship.io/" target="_blank" rel="noopener noreferrer">Codeship<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://stridercd.com/" target="_blank" rel="noopener noreferrer">Strider<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></blockquote> <p>Jenkins 和 Strider 是开源软件，Travis 和 Codeship 对于开源项目可以免费使用。它们都会将构建和测试，在一次运行中执行完成。</p> <h4 id="_4-4-测试-第二轮"><a href="#_4-4-测试-第二轮" class="header-anchor">#</a> 4.4 测试（第二轮）</h4> <p>构建完成，就要进行第二轮测试。如果第一轮已经涵盖了所有测试内容，第二轮可以省略，当然，这时构建步骤也要移到第一轮测试前面。</p> <p>第二轮是全面测试，单元测试和集成测试都会跑，有条件的话，也要做端对端测试。所有测试以自动化为主，少数无法自动化的测试用例，就要人工跑。</p> <p>需要强调的是，新版本的每一个更新点都必须测试到。如果测试的覆盖率不高，进入后面的部署阶段后，很可能会出现严重的问题。</p> <h4 id="_4-5-部署"><a href="#_4-5-部署" class="header-anchor">#</a> 4.5 部署</h4> <p>通过了第二轮测试，当前代码就是一个可以直接部署的版本（artifact）。将这个版本的所有文件打包（ <code>tar filename.tar *</code> ）存档，发到生产服务器。</p> <p>生产服务器将打包文件，解包成本地的一个目录，再将运行路径的符号链接（symlink）指向这个目录，然后重新启动应用。这方面的部署工具有<a href="http://www.ansible.com/" target="_blank" rel="noopener noreferrer">Ansible<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，<a href="https://www.chef.io/chef/" target="_blank" rel="noopener noreferrer">Chef<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，<a href="https://puppetlabs.com/" target="_blank" rel="noopener noreferrer">Puppet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>等。</p> <h4 id="_4-6-回滚"><a href="#_4-6-回滚" class="header-anchor">#</a> 4.6 回滚</h4> <p>一旦当前版本发生问题，就要回滚到上一个版本的构建结果。最简单的做法就是修改一下符号链接，指向上一个版本的目录。</p></div> <div class="page-jump"><a href="/2019/04/25/javascript-%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93/">&lt; JavaScript 代码整洁之道</a> <span></span> <a href="/2019/05/13/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-node/">深入理解 Node &gt;</a></div> <div id="comment"></div></div> <ul class="footer-wrapper content__default"><li><div class="title">关于本站</div> <div class="text"><span>Bougie © 2017-2023</span></div> <div class="text"><a href="https://beian.miit.gov.cn/" rel="noopener noreferrer" target="_blank">鄂ICP备17030443号-1</a></div></li> <li><div class="title">小伙伴们</div> <div title="" class="text"><a href="https://www.chegi.fun/" target="_blank">Chegi's Space</a></div><div title="欢迎来访！" class="text"><a href="http://www.zhangningle.top" target="_blank">张宁乐</a></div></li> <li><div class="title">联系方式</div> <div class="text"><a href="mailto:bougie.liu@qq.com">邮箱：bougie.liu@qq.com</a></div> <div class="text"><a href="/message/">留言：点击留言</a></div></li></ul></main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.49e42e06.js" defer></script><script src="/assets/js/46.b95aad07.js" defer></script>
  </body>
</html>
